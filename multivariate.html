

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Multivariate Distributions &mdash; Distributions.jl 0.2.3 documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.2.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Distributions.jl 0.2.3 documentation" href="index.html" />
    <link rel="prev" title="Univariate Distributions" href="univariate.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">Distributions.jl 0.2.3 documentation</a></div>
        <div class="rel">
          <a href="univariate.html" title="Univariate Distributions"
             accesskey="P">previous</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="multivariate-distributions">
<h1>Multivariate Distributions<a class="headerlink" href="#multivariate-distributions" title="Permalink to this headline">¶</a></h1>
<p><em>Multivariate distributions</em> are probabilistic distributions whose samples are vectors. The <em>Distributions</em> package implements several commonly used multivariate distributions, including <em>Multinomial</em>, <em>Multivairate Normal</em> and <em>Dirichlet</em>.</p>
<div class="section" id="common-interface">
<h2>Common Interface<a class="headerlink" href="#common-interface" title="Permalink to this headline">¶</a></h2>
<p>The methods listed as below are implemented for each multivariate distribution, which provides a consistent interface to work with multivariate distributions.</p>
<div class="section" id="computation-of-statistics">
<h3>Computation of statistics<a class="headerlink" href="#computation-of-statistics" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="dim">
<tt class="descname">dim</tt><big>(</big><em>d</em><big>)</big><a class="headerlink" href="#dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sample dimension.</p>
</dd></dl>

<dl class="function">
<dt id="mean">
<tt class="descname">mean</tt><big>(</big><em>d</em><big>)</big><a class="headerlink" href="#mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean vector of distribution d.</p>
</dd></dl>

<dl class="function">
<dt id="var">
<tt class="descname">var</tt><big>(</big><em>d</em><big>)</big><a class="headerlink" href="#var" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vector of component-wise variances of distribution d.</p>
</dd></dl>

<dl class="function">
<dt id="cov">
<tt class="descname">cov</tt><big>(</big><em>d</em><big>)</big><a class="headerlink" href="#cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the covariance matrix of distribution d.</p>
</dd></dl>

<dl class="function">
<dt id="cor">
<tt class="descname">cor</tt><big>(</big><em>d</em><big>)</big><a class="headerlink" href="#cor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the correlation matrix of distribution d.</p>
</dd></dl>

</div>
<div class="section" id="probability-evaluation">
<h3>Probability evaluation<a class="headerlink" href="#probability-evaluation" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pdf">
<tt class="descname">pdf</tt><big>(</big><em>d</em>, <em>x</em><big>)</big><a class="headerlink" href="#pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the probability density evaluated at x.</p>
<ul class="simple">
<li>If x is a vector, it returns the result as a scalar.</li>
<li>If x is a matrix with n columns, it returns a vector <tt class="docutils literal"><span class="pre">r</span></tt> of length n, where <tt class="docutils literal"><span class="pre">r[i]</span></tt> corresponds to <tt class="docutils literal"><span class="pre">x[:,i]</span></tt> (i.e. treating each column as a sample).</li>
</ul>
</dd></dl>

<dl class="function">
<dt>
<tt class="descname">pdf!(r, d, x)</tt></dt>
<dd><p>Evaluate the probability densities at columns of x, and write the results to a pre-allocated array r.</p>
</dd></dl>

<dl class="function">
<dt id="logpdf">
<tt class="descname">logpdf</tt><big>(</big><em>d</em>, <em>x</em><big>)</big><a class="headerlink" href="#logpdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the logarithm of probability density evaluated at x.</p>
<ul class="simple">
<li>If x is a vector, it returns the result as a scalar.</li>
<li>If x is a matrix with n columns, it returns a vector <tt class="docutils literal"><span class="pre">r</span></tt> of length n, where <tt class="docutils literal"><span class="pre">r[i]</span></tt> corresponds to <tt class="docutils literal"><span class="pre">x[:,i]</span></tt>.</li>
</ul>
</dd></dl>

<dl class="function">
<dt>
<tt class="descname">logpdf!(r, d, x)</tt></dt>
<dd><p>Evaluate the logarithm of probability densities at columns of x, and write the results to a pre-allocated array r.</p>
</dd></dl>

<p><strong>Note:</strong> For multivariate distributions, the pdf value is usually very small or large, and therefore direct evaluating the pdf may cause numerical problems. It is generally advisable to perform probability computation in log-scale.</p>
</div>
<div class="section" id="sampling">
<h3>Sampling<a class="headerlink" href="#sampling" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rand">
<tt class="descname">rand</tt><big>(</big><em>d</em><big>)</big><a class="headerlink" href="#rand" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a vector from the distribution d.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descname">rand</tt><big>(</big><em>d</em>, <em>n</em><big>)</big></dt>
<dd><p>Sample n vectors from the distribution d. This returns a matrix of size <tt class="docutils literal"><span class="pre">(dim(d),</span> <span class="pre">n)</span></tt>, where each column is a sample.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descname">rand!(d, x)</tt></dt>
<dd><p>Draw samples and output them to a pre-allocated array x. Here, x can be either a vector of length <tt class="docutils literal"><span class="pre">dim(d)</span></tt> or a matrix with <tt class="docutils literal"><span class="pre">dim(d)</span></tt> rows.</p>
</dd></dl>

</div>
</div>
<div class="section" id="multinomial-distribution">
<h2>Multinomial Distribution<a class="headerlink" href="#multinomial-distribution" title="Permalink to this headline">¶</a></h2>
<p>The <em>multinomial distribution</em> generalizes the <em>binomial distribution</em>. Consider n independent draws from a Categorical distribution over a finite set of size k, and let <img class="math" src="_images/math/6a54d6512ad7d4c552c2d2231adc0e7a5d550c72.png" alt="X = (X_1, ..., X_k)"/> where <tt class="docutils literal"><span class="pre">X_i</span></tt> represents the number of times the element <tt class="docutils literal"><span class="pre">i</span></tt> occurs, then the distribution of <tt class="docutils literal"><span class="pre">X</span></tt> is a multinomial distribution. Each sample of a multinomial distribution is a k-dimensional integer vector that sums to n.</p>
<p>The probability mass function is given by</p>
<div class="math">
<p><img src="_images/math/22741b9faf43a8230d1155e19fcd18bd7f891f5b.png" alt="f(x; n, p) = \frac{n!}{x_1! \cdots x_k!} \prod_{i=1}^k p_i^{x_i},
\quad x_1 + \cdots + x_k = n"/></p>
</div><div class="highlight-julia"><div class="highlight"><pre><span class="n">Multinomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>   <span class="c"># Multinomial distribution for n trials with probability vector p</span>
</pre></div>
</div>
</div>
<div class="section" id="multivariate-normal-distribution">
<h2>Multivariate Normal Distribution<a class="headerlink" href="#multivariate-normal-distribution" title="Permalink to this headline">¶</a></h2>
<p>The <em>multivariate normal distribution</em> is a multidimensional generalization of the <em>normal distribution</em>. The probability density function of a d-dimensional multivariate normal distribution with mean vector μ and covariance matrix Σ is</p>
<div class="math">
<p><img src="_images/math/a3378f7be45a8aad6115148afacad5f126133fbf.png" alt="f(x; \mu, \Sigma) = \frac{1}{(2 \pi)^{d/2} |\Sigma|^{1/2}}
\exp \left( - \frac{1}{2} (x - \mu)^T \Sigma^{-1} (x - \mu) \right)"/></p>
</div><div class="highlight-julia"><div class="highlight"><pre><span class="c"># Let sig be a scalar</span>
<span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>     <span class="c"># Multivariate normal distribution</span>
                                <span class="c"># with mean mu and covariance sig^2 * I</span>

<span class="c"># Let v be a vector</span>
<span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>       <span class="c"># Multivariate normal distribution</span>
                                <span class="c"># with mean mu and covariance diagm(v)</span>

<span class="c"># Let C be a positive definite matrix</span>
<span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>       <span class="c"># Multivariate normal distribution</span>
                                <span class="c"># with mean mu and covariance C</span>
</pre></div>
</div>
<p>To save some typing, we introduce the name <tt class="docutils literal"><span class="pre">MvNormal</span></tt> as an alias of <tt class="docutils literal"><span class="pre">MultivariateNormal</span></tt>. One can use <tt class="docutils literal"><span class="pre">MvNormal</span></tt> in the place of <tt class="docutils literal"><span class="pre">MultivariateNormal</span></tt> (<em>e.g.</em> <tt class="docutils literal"><span class="pre">MvNormal(mu,</span> <span class="pre">C)</span></tt>.)</p>
<div class="section" id="the-multivariatenormal-type-and-specialized-covariance">
<h3>The MultivariateNormal type and specialized covariance<a class="headerlink" href="#the-multivariatenormal-type-and-specialized-covariance" title="Permalink to this headline">¶</a></h3>
<p><em>MultivariateNormal</em> is a parameteric type declared as below, which takes <tt class="docutils literal"><span class="pre">Cov</span></tt>, the type of the covariance, as an argument, thus enables specialized handling of covariance matrices of different structures.</p>
<div class="highlight-julia"><div class="highlight"><pre><span class="n">immutable</span> <span class="n">MultivariateNormal</span><span class="p">{</span><span class="n">Cov</span><span class="o">&lt;:</span><span class="n">AbstractPDMat</span><span class="p">}</span> <span class="o">&lt;:</span> <span class="n">ContinuousMultivariateDistribution</span>
</pre></div>
</div>
<p>In particular, <tt class="docutils literal"><span class="pre">ScalMat</span></tt>, <tt class="docutils literal"><span class="pre">PDiagMat</span></tt> and <tt class="docutils literal"><span class="pre">PDMat</span></tt> are respectively used as the covariance type for cases where the covariance matrix is respectively isotropic, diagonal, or a full matrix. Consequently, more efficient implementation will be internally used when handling covariance matrix with special structures.</p>
</div>
</div>
<div class="section" id="dirichlet-distribution">
<h2>Dirichlet Distribution<a class="headerlink" href="#dirichlet-distribution" title="Permalink to this headline">¶</a></h2>
<p>The Dirichlet distribution is often used the conjugate prior for Categorical or Multinomial distributions. The probability density function of a Dirichlet distribution with parameter <img class="math" src="_images/math/b7c5b7ad8ce843694f808849755d2f1137630a9a.png" alt="\alpha = (\alpha_1, \ldots, \alpha_k)"/> is</p>
<div class="math">
<p><img src="_images/math/e0e6671543299c015cc756b83deb2aabf49ce3ff.png" alt="f(x; \alpha) = \frac{1}{B(\alpha)} \prod_{i=1}^k x_i^{\alpha_i - 1}, \quad \text{ with }
B(\alpha) = \frac{\prod_{i=1}^k \Gamma(\alpha_i)}{\Gamma \left( \sum_{i=1}^k \alpha_i \right)},
\quad x_1 + \cdots + x_k = 1"/></p>
</div><div class="highlight-julia"><div class="highlight"><pre><span class="c"># Let alpha be a vector</span>
<span class="n">Dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>         <span class="c"># Dirichlet distribution with parameter vector alpha</span>

<span class="c"># Let a be a positive scalar</span>
<span class="n">Dirichlet</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>          <span class="c"># Dirichlet distribution with parameter a * ones(k)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="distributions.html">Distribution Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="univariate.html">Univariate Distributions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Multivariate Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#common-interface">Common Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multinomial-distribution">Multinomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multivariate-normal-distribution">Multivariate Normal Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dirichlet-distribution">Dirichlet Distribution</a></li>
</ul>
</li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="univariate.html" title="Univariate Distributions"
             >previous</a> |
          <a href="genindex.html" title="General Index"
             >index</a>
            <br/>
            <a href="_sources/multivariate.txt"
               rel="nofollow">Show Source</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2013, JuliaStats.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>